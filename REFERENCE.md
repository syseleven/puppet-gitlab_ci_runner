# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

_Public Classes_

* [`gitlab_ci_runner`](#gitlab_ci_runner): This module installs and configures Gitlab CI Runners.

_Private Classes_

* `gitlab_ci_runner::config`: Manages the configuration of Gitlab runner
* `gitlab_ci_runner::install`: Manages the package of Gitlab runner
* `gitlab_ci_runner::repo`: Manages the repository for Gitlab runner
* `gitlab_ci_runner::service`: Manages the service of Gitlab runner

**Defined types**

* [`gitlab_ci_runner::runner`](#gitlab_ci_runnerrunner): This module installs and configures Gitlab CI Runners.

**Functions**

* [`gitlab_ci_runner::register`](#gitlab_ci_runnerregister): A function that registers a Gitlab runner on a Gitlab instance
* [`gitlab_ci_runner::unregister`](#gitlab_ci_runnerunregister): A function that unregisters a Gitlab runner from a Gitlab instance

**Data types**

* [`Gitlab_ci_runner::Register`](#gitlab_ci_runnerregister): A struct of all possible additionl options for gitlab_ci_runner::register

**Tasks**

* [`register_runner`](#register_runner): Registers a runner on a Gitlab instance.
* [`unregister_runner`](#unregister_runner): Unregisters a runner from a Gitlab instance.

## Classes

### gitlab_ci_runner

This module installs and configures Gitlab CI Runners.

#### Examples

##### Simple runner registration

```puppet
class { 'gitlab_ci_runner':
  runners => {
 	 example_runner => {
 		 'registration-token' => 'gitlab-token',
 		 'url'                => 'https://gitlab.com',
 		 'tag-list'           => 'docker,aws',
 	 },
  },
}
```

#### Parameters

The following parameters are available in the `gitlab_ci_runner` class.

##### `runners`

Data type: `Hash`

Hashkeys are used as $title in runners.pp. The subkeys have to be named as the parameter names from ´gitlab-runner register´ command cause they're later joined to one entire string using 2 hyphen to look like shell command parameters. See ´https://docs.gitlab.com/runner/register/#one-line-registration-command´ for details.

##### `runner_defaults`

Data type: `Hash`

A hash with defaults which will be later merged with $runners.

##### `xz_package_name`

Data type: `String`

The name of the 'xz' package. Needed for local docker installations.

##### `concurrent`

Data type: `Optional[Integer]`

Limits how many jobs globally can be run concurrently. The most upper limit of jobs using all defined runners. 0 does not mean unlimited!

Default value: `undef`

##### `builds_dir`

Data type: `Optional[String]`

Absolute path to a directory where builds will be stored in context of selected executor (Locally, Docker, SSH).

Default value: `undef`

##### `cache_dir`

Data type: `Optional[String]`

Absolute path to a directory where build caches will be stored in context of selected executor (locally, Docker, SSH). If the docker executor is used, this directory needs to be included in its volumes parameter.

Default value: `undef`

##### `metrics_server`

Data type: `Optional[Pattern[/.*:.+/]]`

(Deprecated) [host]:<port> to enable metrics server as described in https://docs.gitlab.com/runner/monitoring/README.html#configuration-of-the-metrics-http-server.

Default value: `undef`

##### `listen_address`

Data type: `Optional[Pattern[/.*:.+/]]`

Address (<host>:<port>) on which the Prometheus metrics HTTP server should be listening.

Default value: `undef`

##### `sentry_dsn`

Data type: `Optional[String]`

Enable tracking of all system level errors to sentry.

Default value: `undef`

##### `manage_docker`

Data type: `Boolean`

If docker should be installs (uses the puppetlabs-docker).

Default value: `true`

##### `manage_repo`

Data type: `Boolean`

If the repository should be managed.

Default value: `true`

##### `package_ensure`

Data type: `String`

The package 'ensure' state.

Default value: installed

##### `package_name`

Data type: `String`

The name of the package.

Default value: 'gitlab-runner'

##### `repo_base_url`

Data type: `Stdlib::HTTPUrl`

The base repository url.

Default value: 'https://packages.gitlab.com'

##### `repo_keyserver`

Data type: `Stdlib::Fqdn`

The keyserver which should be used to get the repository key.

Default value: 'keys.gnupg.net'

##### `config_path`

Data type: `String`

The path to the config file of Gitlab runner.

Default value: '/etc/gitlab-runner/config.toml'

## Defined types

### gitlab_ci_runner::runner

This module installs and configures Gitlab CI Runners.

#### Parameters

The following parameters are available in the `gitlab_ci_runner::runner` defined type.

##### `binary`

Data type: `String`

The name of the Gitlab runner binary.

##### `runners_hash`

Data type: `Hash`

Hash with configuration for runners.

##### `default_config`

Data type: `Hash`

Hash with default configration for runners. This will be merged with the runners_hash config.

Default value: {}

## Functions

### gitlab_ci_runner::register

Type: Ruby 4.x API

A function that registers a Gitlab runner on a Gitlab instance

#### `gitlab_ci_runner::register(Stdlib::HTTPUrl $url, String[1] $token, Optional[Gitlab_ci_runner::Register] $additional_options)`

The gitlab_ci_runner::register function.

Returns: `Struct[{ id => Integer[1], token => String[1], }]`

##### `url`

Data type: `Stdlib::HTTPUrl`

The url to your Gitlab instance. Please only provide the host part (e.g https://gitlab.com)

##### `token`

Data type: `String[1]`

Registration token.

##### `additional_options`

Data type: `Optional[Gitlab_ci_runner::Register]`

A hash with all additional configuration options for that runner

### gitlab_ci_runner::unregister

Type: Ruby 4.x API

A function that unregisters a Gitlab runner from a Gitlab instance

#### `gitlab_ci_runner::unregister(Stdlib::HTTPUrl $url, String[1] $token)`

The gitlab_ci_runner::unregister function.

Returns: `Struct[{ status => Enum['success'], }]`

##### `url`

Data type: `Stdlib::HTTPUrl`

The url to your Gitlab instance. Please only provide the host part (e.g https://gitlab.com)

##### `token`

Data type: `String[1]`

Runners authentication token.

## Data types

### Gitlab_ci_runner::Register

A struct of all possible additionl options for gitlab_ci_runner::register

Alias of `Struct[{
  Optional[description]     => String[1],
  Optional[info]            => Hash[String[1],String[1]],
  Optional[active]          => Boolean,
  Optional[locked]          => Boolean,
  Optional[run_untagged]    => Boolean,
  Optional[tag_list]        => Array[String[1]],
  Optional[access_level]    => Enum['not_protected', 'ref_protected'],
  Optional[maximum_timeout] => Integer,
}]`

## Tasks

### register_runner

Registers a runner on a Gitlab instance.

**Supports noop?** false

#### Parameters

##### `url`

Data type: `String[1]`

The url to your Gitlab instance. Please only provide the host part (e.g https://gitlab.com)

##### `token`

Data type: `String[1]`

Registration token.

##### `description`

Data type: `Optional[String[1]]`

Runners description.

##### `info`

Data type: `Optional[Hash]`

Runners metadata.

##### `active`

Data type: `Optional[Boolean]`

Whether the Runner is active.

##### `locked`

Data type: `Optional[Boolean]`

Whether the Runner should be locked for current project.

##### `run_untagged`

Data type: `Optional[Boolean]`

Whether the Runner should handle untagged jobs.

##### `tag_list`

Data type: `Optional[Array[String[1]]]`

List of Runners tags.

##### `access_level`

Data type: `Optional[Enum['not_protected', 'ref_protected']]`

The access_level of the runner.

##### `maximum_timeout`

Data type: `Optional[Integer[1]]`

Maximum timeout set when this Runner will handle the job.

### unregister_runner

Unregisters a runner from a Gitlab instance.

**Supports noop?** false

#### Parameters

##### `url`

Data type: `String[1]`

The url to your Gitlab instance. Please provide the host part only! (e.g https://gitlab.com)

##### `token`

Data type: `String[1]`

Runners authentication token.

